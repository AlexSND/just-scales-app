import styles from './Config.module.scss';
import {useMemo} from 'react';
import {useDispatch, useSelector} from 'react-redux';
import {RootState} from '../../store';
import {setCompactView} from '../../app.slice';
import {classNames} from '../../shared/utils/classNames';

export const Config = () => {
  const dispatch = useDispatch();
  const compactView = useSelector((state: RootState) => state.app.compactView);
  const mainNote = useSelector((state: RootState) => state.app.mainNote);
  const selectedScales = useSelector((state: RootState) => state.app.selectedScales);
  const scaleDetection = useSelector((state: RootState) => state.app.scaleDetection);

  const onSetCompactView = (state: boolean) => {
    dispatch(setCompactView(state));
  }

  const compactButton = useMemo(() => <div className={classNames([styles.compactBtn, (mainNote && !scaleDetection && selectedScales.length) ? '' : styles.disabled])} onClick={() => onSetCompactView(true)}>
    <svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 49.98"><g id="Layer_1-2"><path d="m14.65,33.54c-3.26-.04-6.52-.01-9.78,0-.51,0-1.01.12-1.35.57-.39.52-.6,1.07-.32,1.71.3.69.81,1.11,1.57,1.2,1.52.18,3.04.08,4.56.11.22,0,.52-.1.62.22.09.28-.17.42-.33.59-1.97,1.96-3.93,3.92-5.91,5.88-.99.98-2,1.93-2.96,2.93-.89.93-.92,1.85-.18,2.62.79.82,1.65.8,2.68-.08.16-.14.31-.29.46-.44,2.83-2.8,5.62-5.64,8.37-8.52.2-.21.37-.65.72-.49.29.13.13.54.13.82,0,1.47-.02,2.94.02,4.41.03,1.16.78,1.91,1.75,1.85,1.03-.06,1.81-.95,1.8-2.06,0-1.52,0-3.04,0-4.57,0,0,0,0,.01,0,0-1.6.03-3.21,0-4.81-.03-1.26-.65-1.95-1.86-1.96Z"/><path d="m49.3,46.76c-.96-1-1.98-1.95-2.96-2.93-1.97-1.96-3.94-3.92-5.91-5.88-.17-.17-.42-.31-.33-.59.1-.31.4-.21.62-.22,1.52-.03,3.05.07,4.56-.11.76-.09,1.27-.51,1.57-1.2.28-.65.07-1.19-.32-1.71-.34-.46-.84-.57-1.35-.57-3.26-.02-6.52-.04-9.78,0-1.21.01-1.83.7-1.86,1.96-.04,1.6,0,3.21,0,4.81,0,0,0,0,.01,0,0,1.52,0,3.04,0,4.57,0,1.1.77,2,1.8,2.06.98.05,1.72-.7,1.75-1.85.04-1.47.01-2.94.02-4.41,0-.28-.16-.69.13-.82.36-.17.53.28.72.49,2.75,2.88,5.54,5.72,8.37,8.52.15.15.3.3.46.44,1.03.88,1.89.91,2.68.08.74-.78.71-1.7-.18-2.62Z"/><path d="m3.67,6.15c1.97,1.96,3.94,3.92,5.91,5.88.17.17.42.31.33.59-.1.31-.4.21-.62.22-1.52.03-3.05-.07-4.56.11-.76.09-1.27.51-1.57,1.2-.28.65-.07,1.19.32,1.71.34.46.84.57,1.35.57,3.26.02,6.52.04,9.78,0,1.21-.01,1.83-.7,1.86-1.96.04-1.6,0-3.21,0-4.81,0,0,0,0-.01,0,0-1.52,0-3.04,0-4.57,0-1.1-.77-2-1.8-2.06-.98-.05-1.72.7-1.75,1.85-.04,1.47-.01,2.94-.02,4.41,0,.28.16.69-.13.82-.36.17-.53-.28-.72-.49C9.28,6.76,6.49,3.92,3.66,1.13c-.15-.15-.3-.3-.46-.44C2.17-.2,1.31-.23.52.6c-.74.78-.71,1.7.18,2.62.96,1,1.98,1.95,2.96,2.93Z"/><path d="m35.35,16.44c3.26.04,6.52.01,9.78,0,.51,0,1.01-.12,1.35-.57.39-.52.6-1.07.32-1.71-.3-.69-.81-1.11-1.57-1.2-1.52-.18-3.04-.08-4.56-.11-.22,0-.52.1-.62-.22-.09-.28.17-.42.33-.59,1.97-1.96,3.93-3.92,5.91-5.88.99-.98,2-1.93,2.96-2.93.89-.93.92-1.85.18-2.62-.79-.82-1.65-.8-2.68.08-.16.14-.31.29-.46.44-2.83,2.8-5.62,5.64-8.37,8.52-.2.21-.37.65-.72.49-.29-.13-.13-.54-.13-.82,0-1.47.02-2.94-.02-4.41-.03-1.16-.78-1.91-1.75-1.85-1.03.06-1.81.95-1.8,2.06,0,1.52,0,3.04,0,4.57,0,0,0,0-.01,0,0,1.6-.03,3.21,0,4.81.03,1.26.65,1.95,1.86,1.96Z"/><rect x="16.52" y="16.36" width="17" height="17.16" rx="4.14" ry="4.14"/></g></svg>
  </div>, [mainNote, scaleDetection, selectedScales])

  const uncompactButton = useMemo(() => <div className={styles.compactBtn} onClick={() => onSetCompactView(false)}>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 49.98"><path d="M1.92 49.96c3.26.04 6.52.01 9.78 0 .51 0 1.01-.12 1.35-.57.39-.52.6-1.07.32-1.71-.3-.69-.81-1.11-1.57-1.2-1.52-.18-3.04-.08-4.56-.11-.22 0-.52.1-.62-.22-.09-.28.17-.42.33-.59 1.97-1.96 3.93-3.92 5.91-5.88.99-.98 2-1.93 2.96-2.93.89-.93.92-1.85.18-2.62-.79-.82-1.65-.8-2.68.08-.16.14-.31.29-.46.44-2.83 2.8-5.62 5.64-8.37 8.52-.2.21-.37.65-.72.49-.29-.13-.13-.54-.13-.82 0-1.47.02-2.94-.02-4.41-.03-1.16-.78-1.91-1.75-1.85-1.03.06-1.81.95-1.8 2.06v4.57H.06c0 1.6-.03 3.21 0 4.81.03 1.26.65 1.95 1.86 1.96ZM34.22 36.74c.96 1 1.98 1.95 2.96 2.93l5.91 5.88c.17.17.42.31.33.59-.1.31-.4.21-.62.22-1.52.03-3.05-.07-4.56.11-.76.09-1.27.51-1.57 1.2-.28.65-.07 1.19.32 1.71.34.46.84.57 1.35.57 3.26.02 6.52.04 9.78 0 1.21-.01 1.83-.7 1.86-1.96.04-1.6 0-3.21 0-4.81h-.01v-4.57c0-1.1-.77-2-1.8-2.06-.98-.05-1.72.7-1.75 1.85-.04 1.47-.01 2.94-.02 4.41 0 .28.16.69-.13.82-.36.17-.53-.28-.72-.49-2.75-2.88-5.54-5.72-8.37-8.52-.15-.15-.3-.3-.46-.44-1.03-.88-1.89-.91-2.68-.08-.74.78-.71 1.7.18 2.62ZM12.82 10.31 6.91 4.43c-.17-.17-.42-.31-.33-.59.1-.31.4-.21.62-.22 1.52-.03 3.05.07 4.56-.11.76-.09 1.27-.51 1.57-1.2.28-.65.07-1.19-.32-1.71-.34-.46-.84-.57-1.35-.57C8.39 0 5.13-.02 1.87.02.67.03.05.72.02 1.98c-.04 1.6 0 3.21 0 4.81h.01v4.57c0 1.1.77 2 1.8 2.06.98.05 1.72-.7 1.75-1.85.04-1.47.01-2.94.02-4.41 0-.28-.16-.69.13-.82.36-.17.53.28.72.49 2.75 2.88 5.54 5.72 8.37 8.52.15.15.3.3.46.44 1.03.88 1.89.91 2.68.08.74-.78.71-1.7-.18-2.62-.96-1-1.98-1.95-2.96-2.93ZM48.08.02c-3.26-.04-6.52-.01-9.78 0-.51 0-1.01.12-1.35.57-.39.52-.6 1.07-.32 1.71.3.69.81 1.11 1.57 1.2 1.52.18 3.04.08 4.56.11.22 0 .52-.1.62.22.09.28-.17.42-.33.59-1.97 1.96-3.93 3.92-5.91 5.88-.99.98-2 1.93-2.96 2.93-.89.93-.92 1.85-.18 2.62.79.82 1.65.8 2.68-.08.16-.14.31-.29.46-.44 2.83-2.8 5.62-5.64 8.37-8.52.2-.21.37-.65.72-.49.29.13.13.54.13.82 0 1.47-.02 2.94.02 4.41.03 1.16.78 1.91 1.75 1.85 1.03-.06 1.81-.95 1.8-2.06V6.77h.01c0-1.6.03-3.21 0-4.81C49.91.7 49.29.01 48.08 0Z"/><rect x="16.52" y="16.36" width="17" height="17.16" rx="4.14" ry="4.14"/></svg>
  </div>, [])

  return (
    <div className={styles.wrapper}>
      {compactView ? uncompactButton : compactButton}
    </div>
  )
}