import styles from './Config.module.scss';
import {useMemo} from 'react';
import {useDispatch, useSelector} from 'react-redux';
import {RootState} from '../../store';
import {setCompactView} from '../../app.slice';
import {classNames} from '../../shared/utils/classNames';

export const Config = () => {
  const dispatch = useDispatch();
  const compactView = useSelector((state: RootState) => state.app.compactView);
  const mainNote = useSelector((state: RootState) => state.app.mainNote);
  const selectedScales = useSelector((state: RootState) => state.app.selectedScales);
  const scaleDetection = useSelector((state: RootState) => state.app.scaleDetection);

  const onSetCompactView = (state: boolean) => {
    dispatch(setCompactView(state));
  }

  const compactButton = useMemo(() => <div className={classNames([styles.compactBtn, (mainNote && !scaleDetection && selectedScales.length) ? '' : styles.disabled])} onClick={() => onSetCompactView(true)}>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" fill="none"><path fill="#000" d="M29.616 16h-9.232C17.963 16 16 17.944 16 20.343v9.314C16 32.056 17.963 34 20.384 34h9.232C32.038 34 34 32.056 34 29.657v-9.314C34 17.944 32.037 16 29.616 16ZM3.564 44.019 9.298 38.3c.165-.165.408-.301.32-.574-.097-.301-.388-.204-.601-.214-1.475-.029-2.96.069-4.424-.106-.738-.088-1.232-.496-1.524-1.167-.271-.633-.067-1.158.311-1.663.33-.448.815-.554 1.31-.554 3.163-.02 6.325-.04 9.488 0 1.174.01 1.776.68 1.805 1.905.039 1.556 0 3.122 0 4.678h-.01v4.444c0 1.07-.747 1.945-1.746 2.003-.951.048-1.669-.68-1.698-1.8-.039-1.429-.01-2.858-.02-4.288 0-.272.156-.67-.126-.797-.349-.165-.514.272-.698.477a465.337 465.337 0 0 1-8.13 8.255 9.294 9.294 0 0 1-.447.428c-.999.866-1.833.895-2.6.088-.718-.759-.689-1.653.175-2.548.931-.972 1.92-1.896 2.872-2.85h.01ZM46.436 5.981 40.702 11.7c-.165.165-.408.301-.32.574.097.301.388.204.601.214 1.475.029 2.96-.069 4.424.107.738.087 1.233.495 1.524 1.166.271.633.067 1.158-.31 1.663-.33.448-.816.554-1.31.554-3.163.02-6.326.04-9.49 0-1.173-.01-1.775-.68-1.804-1.905-.039-1.556 0-3.122 0-4.678h.01V4.95c0-1.07.747-1.944 1.746-2.003.951-.048 1.669.68 1.698 1.8.039 1.429.01 2.858.02 4.287 0 .273-.156.671.126.798.349.165.514-.272.698-.477a465.507 465.507 0 0 1 8.13-8.255c.146-.146.291-.292.447-.428.999-.866 1.833-.895 2.6-.088.718.759.689 1.653-.175 2.548-.931.972-1.92 1.896-2.872 2.85h-.01ZM46.436 44.019 40.702 38.3c-.165-.165-.408-.301-.32-.574.097-.301.388-.204.601-.214 1.475-.029 2.96.069 4.424-.106.738-.088 1.233-.496 1.524-1.167.271-.633.067-1.158-.31-1.663-.33-.448-.816-.554-1.31-.554-3.163-.02-6.326-.04-9.49 0-1.173.01-1.775.68-1.804 1.905-.039 1.556 0 3.122 0 4.678h.01v4.444c0 1.07.747 1.945 1.746 2.003.951.048 1.669-.68 1.698-1.8.039-1.429.01-2.858.02-4.288 0-.272-.156-.67.126-.797.349-.165.514.272.698.477a465.405 465.405 0 0 0 8.13 8.255c.146.146.291.292.447.428.999.866 1.833.895 2.6.088.718-.759.689-1.653-.175-2.548-.931-.972-1.92-1.896-2.872-2.85h-.01ZM3.564 5.981 9.298 11.7c.165.165.408.301.32.574-.097.301-.388.204-.601.214-1.475.029-2.96-.069-4.424.107-.738.087-1.232.495-1.524 1.166-.271.633-.067 1.158.311 1.663.33.448.815.554 1.31.554 3.163.02 6.325.04 9.488 0 1.174-.01 1.776-.68 1.805-1.905.039-1.556 0-3.122 0-4.678h-.01V4.95c0-1.07-.747-1.944-1.746-2.003-.951-.048-1.669.68-1.698 1.8-.039 1.429-.01 2.858-.02 4.287 0 .273.156.671-.126.798-.349.165-.514-.272-.698-.477A465.44 465.44 0 0 0 3.555 1.1C3.409.954 3.264.808 3.108.672 2.11-.194 1.275-.223.508.584c-.718.759-.689 1.653.175 2.548.931.972 1.92 1.896 2.872 2.85h.01Z"/></svg>
  </div>, [mainNote, scaleDetection, selectedScales])

  const uncompactButton = useMemo(() => <div className={styles.compactBtn} onClick={() => onSetCompactView(false)}>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" fill="none"><path fill="#000" d="M29.616 16h-9.232C17.963 16 16 17.944 16 20.343v9.314C16 32.056 17.963 34 20.384 34h9.232C32.038 34 34 32.056 34 29.657v-9.314C34 17.944 32.037 16 29.616 16ZM12.436 39.981 6.702 45.7c-.165.165-.408.301-.32.574.097.301.388.204.601.214 1.475.029 2.96-.069 4.424.106.738.088 1.232.496 1.524 1.167.271.633.067 1.158-.31 1.663-.33.448-.816.554-1.31.554-3.164.02-6.326.04-9.49 0-1.173-.01-1.775-.68-1.804-1.905-.039-1.556 0-3.122 0-4.678h.01V38.95c0-1.07.747-1.945 1.746-2.003.951-.048 1.669.68 1.698 1.8.039 1.429.01 2.858.02 4.288 0 .272-.156.67.126.797.349.165.514-.272.698-.477a465.405 465.405 0 0 1 8.13-8.255c.146-.146.291-.292.447-.428.999-.866 1.833-.895 2.6-.088.718.759.689 1.653-.175 2.548-.931.972-1.92 1.896-2.872 2.85h-.01ZM37.564 10.019 43.298 4.3c.165-.165.408-.301.32-.574-.097-.301-.388-.204-.601-.214-1.475-.029-2.96.069-4.424-.107-.738-.087-1.233-.495-1.524-1.166-.271-.633-.067-1.158.31-1.663.33-.448.816-.555 1.31-.555 3.163-.019 6.326-.038 9.49 0 1.173.01 1.775.681 1.804 1.906.039 1.556 0 3.122 0 4.678h-.01v4.444c0 1.07-.747 1.944-1.746 2.003-.951.048-1.669-.68-1.698-1.8-.039-1.429-.01-2.858-.02-4.288 0-.272.156-.67-.126-.797-.349-.165-.514.272-.698.477a465.37 465.37 0 0 1-8.13 8.255 9.294 9.294 0 0 1-.447.428c-.999.866-1.833.895-2.6.088-.718-.759-.689-1.653.175-2.548.931-.972 1.92-1.896 2.872-2.85h.01ZM37.564 39.981l5.734 5.718c.165.165.408.301.32.574-.097.301-.388.204-.601.214-1.475.029-2.96-.069-4.424.106-.738.088-1.233.496-1.524 1.167-.271.633-.067 1.158.31 1.663.33.448.816.554 1.31.554 3.163.02 6.326.04 9.49 0 1.173-.01 1.775-.68 1.804-1.905.039-1.556 0-3.122 0-4.678h-.01V38.95c0-1.07-.747-1.945-1.746-2.003-.951-.048-1.669.68-1.698 1.8-.039 1.429-.01 2.858-.02 4.288 0 .272.156.67-.126.797-.349.165-.514-.272-.698-.477a465.405 465.405 0 0 0-8.13-8.255 9.294 9.294 0 0 0-.447-.428c-.999-.866-1.833-.895-2.6-.088-.718.759-.689 1.653.175 2.548.931.972 1.92 1.896 2.872 2.85h.01ZM12.436 10.019 6.702 4.3c-.165-.165-.408-.301-.32-.574.097-.301.388-.204.601-.214 1.475-.029 2.96.069 4.424-.107.738-.087 1.232-.495 1.524-1.166.271-.633.067-1.158-.31-1.663-.33-.448-.816-.555-1.31-.555-3.164-.019-6.326-.038-9.49 0C.649.032.047.703.018 1.928c-.039 1.556 0 3.122 0 4.678h.01v4.444c0 1.07.747 1.944 1.746 2.003.951.048 1.669-.68 1.698-1.8.039-1.429.01-2.858.02-4.288 0-.272-.156-.67.126-.797.349-.165.514.272.698.477a465.37 465.37 0 0 0 8.13 8.255c.146.146.291.292.447.428.999.866 1.833.895 2.6.088.718-.759.689-1.653-.175-2.548-.931-.972-1.92-1.896-2.872-2.85h-.01Z"/></svg>
  </div>, [])

  return compactView ? uncompactButton : compactButton;
}